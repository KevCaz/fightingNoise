---
title: "Fighting noise with dimensionality"
# subtitle: ""
author: "inSileco"
date: "2018/02/16"
output:
  xaringan::moon_reader:
    includes:
      in_header: inSileco-header.html
    lib_dir: assets
    seal: false
    css: ["default", "inSileco.css", "inSileco-fonts.css"]
    nature:
      beforeInit: "inSileco-macros.js"
      #autoplay: 30000
      #countdown: 60000
---

```{r setup, echo = F}
library(graphicsutils)
source("rscripts/figDens.R")
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  fig.width = 8,
  fig.height = 6,
  fig.align = 'center',
  width = 120
)
mypar <- list(fg = "#303940", bg = "transparent", mar = c(2, 2, 0, 2))
pal <- gpuPalette("insileco")
col2 <- "#3fb3b2"
col1 <- "#375771"
seqx <- seq(-10, 10, .05)
```

<!-- decktape --no-sandbox file:///home/kevcaz/Github/Talks/fightingNoise/index.html /home/kevcaz/Github/Talks/fightingNoise/fightingNoise_KC.pdf -->

<img src = "img/logoUoG.png" style = "position:absolute; width:180px; height:100px; top:240px; right:15px;"></img>

## ![:faic](angle-double-right) Fighting noise with dimensionality

##### The more biotracers the better!

<br><br>

#####  ![:faic](users) Kevin Cazelles &nbsp; .small[[McCannLab](https://www.mccannlab.org/)]

###### Emelia Myles-Gonzalez, Tyler Zemlak, Kevin S. McCann

<br>

.column2[

<br>

###### ![:faic](globe) CSEE 2018 - University of Guelph
###### ![:faic](github) [KevCaz/fightingNoise](https://github.com/KevCaz/fightingNoise) &nbsp;&nbsp; ![:faic](twitter) [KCazelles](https://twitter.com/KCazelles)

]

.column2[
 &nbsp;
.right[ [![:scale 16%](img/inSilecoLogo.png)](https://insileco.github.io/) ]
]









---
class: inverse, center, middle

# Before I start

## Facts that are worth mentioning


---

# Facts that are worth mentioning

<br>

### 1. I won't talk about any trophic interaction

--

### 2. Fish? hum, yes!

--

### 3. I'm not trying to reinvent the wheel






---
class: inverse, center, middle

# Context

## The push for provenance


---
# The push for provenance

<br>

> Consumers are become increasingly aware of, and interested in, the origins
of their seafood, particularly as issues such as environmental sustainability,
impacts on endangered species, toxin accumulations, incidents of illegal,
unregulated and unreported (IUU) fishing, quality assurances and human
rights abuses are better understood.

* ![:faic](file-text) Roebuck, K. et al. (2017)
[Canadian's Eating in the Dark: A Report Card of International
Seafood Labelling Requirements](http://www.seachoice.org/wp-content/uploads/2017/03/Seafood-Labelling-Report-Online.pdf)




---
# The push for provenance

<br>

#### - We need regulations

##### *e.g.* Country of Origin Labelling (COOL) in USA

<br>

--

#### - We need tools to authenticate the provenance

##### ![:faic](arrow-right) What this talk is about!


---
# Biotracers

#### Anything that could be informative...

- trace elements,
- isotopes (delta),
- genetics data,
- gut contents,
- etc.

#### ... to create spatial fingerprints


---
# A silver bullet?

<br>

>  The future of food authentication and food quality assurance critically
depends on combining chemometrics, computational analytical methods,
and bioinformatics in processing and interpreting the data obtained through
analytical technique.

* ![:faic](file-text) Danezis, G. P., et al. (2016)
[Food authentication: state of the art and prospects](https://www.sciencedirect.com/science/article/pii/S2214799316300844).
*Current Opinion in Food Science*]


---
# Questions

<br>

## Where does this sample come from?

--

<br>

####  ![:faic](angle-double-right ) Why should we combine multiple sources of information in this context?



---
# Where does this this lot come from?


<br>

![](img/fig_map1.png)

##### 1- Bering sea &nbsp;&nbsp; 2. Barents sea &nbsp;&nbsp; 3. Okhotsk sea

--
#### ![:faic](arrow-right) So... 1, 2, or 3?


<!-- https://www.alaskankingcrab.com/blogs/resources/blog-learn-fishing-for-king-crab -->











---
class: inverse, center, middle

# Theory

## a Bayesian framework


<!--need to define what is a meningful geographic area  -->


---
# Basic ideas - multiple origins

```{R figA1, echo = F, fig.height = 4.5}
par(mypar)
figDens(seqx, means = c(-1), sds = c(1), pal = c(col1, col2), lwd = 3)
text(-1.6, .34, labels = "Origin 1", col = col1, pos = 2, cex = 2)
```

---
# Basic ideas - multiple origins

```{R figA2, echo = F, fig.height = 4.5}
par(mypar)
figDens(seqx, means = c(-1, .5), sds = c(1, 1.5), pal = c(col1, col2), lwd = 3)
text(-1.6, .34, labels = "Origin 1", col = col1, pos = 2, cex = 2)
text(1.4, .22, labels = "Origin 2", col = col2, pos = 4, cex = 2)
```


---
# Basic ideas - multiple origins

```{R fig0, echo = F}
par(mypar, mfrow = c(2,1), mar = c(3, 4, 0, 1))
figDens(seqx, ylim = c(0, .8), runif(8, -2, 2), runif(8, .5, 2), pal = colorRampPalette(c(col1, "grey80"))(8), xlab = "Biotracer 1", lwd = 3)
figDens(seqx, ylim = c(0, .8), runif(8, -2, 2), runif(8, .5, 2), pal = colorRampPalette(c(col1, "grey80"))(8), xlab = "Biotracer 2", lwd = 3)
```

---
# Basic ideas - multiple origins

<br>

### .alert[Distributions are known]

--

### do not waste data, build relevant database!


---
# Basic ideas - multiple origins

```{R figA3, echo = F, fig.height = 4.25}
par(mypar)
figDens(seqx, means = c(-1, .5), sds = c(1, 1.5), pal = c(col1, col2), lwd = 3, ylim = c(0, .44))
text(-1.6, .34, labels = "Origin 1 TRUE", col = col1, pos = 2, cex = 2)
text(1.4, .22, labels = "Origin 2 FALSE", col = col2, pos = 4, cex = 2)
```

### &nbsp; O<sub>1</sub> | Sample ?  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sample | O<sub>i</sub> known!


---
# A bayesian apporach

<br>

- .alert[Assumptions]:

  - sample from one of the areas considered
  - no mixture

--

- .alert[Question] O<sub>1</sub> | S<sub>n</sub>?

--

- .alert[Method:] Bayesian inversion rule


<!-- $$[O_1|S_{n}] = \frac{[S_{n}|O_1][O_1]}{\sum_j [S_{n}|O_j][O_j]}$$ -->




---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigMu1.png)]


---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigMu2.png)]

---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigMu3.png)]

---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigMu4.png)]


---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigMu5.png)]


---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigMu6.png)]


---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigMu7.png)]




---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigSd1.png)]


---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigSd2.png)]

---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigSd3.png)]

---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigSd4.png)]


---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigSd5.png)]


---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigSd6.png)]


---
# Theory - dissimilarity
<br>

.center[![:scale 94%](img/FigSd7.png)]

--

## ![:faic](angle-double-right) The more dissimilar the better




---
# Theory - dimensionality


#### Biotracers ~ N(μ, Σ)

--

##### μ: means - fixed

--

##### Σ: covariance matrix

- diagonal (variances) fixed

- off-diagonal terms (symetric) vary:

.center[![:scale 20%](img/covariance.png)]

<!-- \begin{pmatrix}
1 & \rho \\
\rho & 1
\end{pmatrix} -->




---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor1.png)]

---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor2.png)]

---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor3.png)]

---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor4.png)]

---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor5.png)]

---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor6.png)]

---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor7.png)]

---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor8.png)]

---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor9.png)]

---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor10.png)]

---
# Theory - dimensionality (dim = 2)

.center[![:scale 77%](img/FigCor11.png)]




---
# Theory - dimensionality (up to 10)

.center[![:scale 70%](img/fig_theo3a.png)]

---
# Theory - dimensionality (up to 10)

.center[![:scale 70%](img/fig_theo3b.png)]


---
# Results

<br>

#### 1. the more dissimilar the better

#### 2. any extra biotracer likely brings something new

#### 3. the more the biotracers the better!

<br>

--

##### ![:faic](angle-double-right) The curse of dimensionality becomes the blessing of dimensionality.










---
class: inverse, center, middle

# Applying the framework

## The King crab example

---
# King Crab - an example

<br>

![](img/fig_map1.png)

--

#### - .alert[Question]: O<sub>1</sub>|S<sub>n</sub>?

---
# King Crab - an example

#### - .alert[Assumptions]:

#### * The sample is from one of the three areas

#### * No temporal variation

#### * No mixture



---
# King Crab - isoscapes

<br>

![](img/fig_map1a.png)

- ![:faic](external-link) [Global Seawater Oxygen-18 Databass](https://data.giss.nasa.gov/o18data/grid.html)

---
# King Crab - isoscapes

<br>

![](img/fig_map2a.png)

- ![:faic](file-text) Magozzi, S., et al. (2017) [Using ocean models to predict spatial and temporal variation in marine carbon isotopes.](https://data.giss.nasa.gov/o18data/grid.html) *Ecosphere*


---
# King Crab - isoscapes

<br>

## ![:faic](arrow-right) δ<sup>18</sup>O + δ<sup>13</sup>C

<br>

## ![:faic](arrow-right) cor(δDp, δ<sup>18</sup>O) = .99






---
# King Crab - raw distribution

<br>

![:scalec 92%](img/fig_Distr1.png)

---
# King Crab - raw distribution

![:scalec 80%](img/fig_Res1a.png)

---
# King Crab - raw distribution

![:scalec 80%](img/fig_Res1aa.png)

---
# King Crab - raw distribution

![:scalec 80%](img/fig_Res1b.png)

---
# King Crab - raw distribution

![:scalec 80%](img/fig_Res1bb.png)



---
# King Crab - raw distribution

<br>

![:scalec 92%](img/fig_Distr1.png)


---
# King Crab - raw distribution + noise

<br>

![:scalec 92%](img/fig_Distr2.png)

---
# King Crab - raw distribution

![:scalec 80%](img/fig_Res2a.png)

---
# King Crab - raw distribution

![:scalec 80%](img/fig_Res2b.png)


---
# King Crab - results

<br>

.column[
  ![:scalec 90%](img/fig_Res1bb.png)
]

.column[
  ![:scalec 45%](img/fig_Res2b.png)
]

--

### ![:faic](arrow-right) Fighting noise with dimensionality!














---
class: inverse, center, middle

# Perspectives


---
# Perspectives


## ![:faic](arrow-right) Theory

  - Spatial autocorrelation
  - Mixture problem
  - Temporal variations

--

##  ![:faic](arrow-right) Applying the framework

  - More than 2 dimensions
  - Isoscape and more
  - Based on real samples


---
# Thanks to

--

### - my coauthors and [the McCannLab](https://www.mccannlab.org/)

--

### - [Food From Though](https://arrellfoodinstitute.ca/food-from-thought/)

![:scalec 34%](img/CanadaFirst.png)

--

### - [Biodiversity Resilience Network](http://birn.editmy.website/)

![:scalec 26%](img/BiRN_logo.png)


---
class: inverse, center, middle

# THE END


---
# Spatial correlation

# ![](img/fig_theo4.png)


---
# ![:faic](angle-double-right) The more dissimilar the better

```{R fig1, echo = F, fig.height = 4.5}
par(mypar)
figDens(seqx, .1*c(-1, 1), pal = c(col1, col2), lwd = 3, ylim = c(0,.42))
text(-1, .3, labels = "Origin 1", col = col1, pos = 2, cex = 2)
text(1, .3, labels = "Origin 2", col = col2, pos = 4, cex = 2)
# tex
```

#### .alert[![:faic](arrow-right) Tricky!]


---
# ![:faic](angle-double-right) The more dissimilar the better

```{R fig2, echo = F, fig.height = 4.5}
par(mypar)
figDens(seqx, 1*c(-1, 1), pal = c(col1, col2), lwd = 3, ylim = c(0,.42))
text(-2, .3, labels = "Origin 1", col = col1, pos = 2, cex = 2)
text(2, .3, labels = "Origin 2", col = col2, pos = 4, cex = 2)
```

#### .alert[![:faic](arrow-right) Easier!]

---
# ![:faic](angle-double-right) The more dissimilar the better

```{R fig3, echo = F, fig.height = 4.5}
par(mypar)
figDens(seqx, .15*c(-1, .1), sds = c(1, 2), pal = c(col1, col2), lwd = 3)
text(-1, .3, labels = "Origin 1", col = col1, pos = 2, cex = 2)
text(1.2, .18, labels = "Origin 2", col = col2, pos = 4, cex = 2)
```

#### .alert[![:faic](arrow-right) Easier!]



---
# Basic ideas - more dimensions

```{R fig4, echo = F}
par(mypar)
figOneDim(col1, col2)
```

---
# Bayesian rule

![:scalec 40%](img/Bayes.png)



---
# Basic ideas - more dimensions

```{R fig5, echo = F, fig.height = 4.8}
par(mypar)
par(mar = c(3, 3, 2, 2))
figTwoDims(col1, col2)
```

##### ![:faic](angle-double-right) Dimensionality ![:faic](arrow-up) then relative overlap ![:faic](arrow-down)



---
# Study case - King Crab

#### Has it been caught illegaly?

> [For decades, Alaska crabbers have competed against king crab illegally caught by Russian fleets.](https://thefishsite.com/articles/alaska-fish-factor-king-crab-fishers-welcome-crack-down-on-illegal-fishing)

- illegal area / unauthorized fleets
- illegal, unreported and unregulated (IUU) fishing has tremendous economical consequences

#### Where does this lot of King crab come from?

- [consumer right-to-know](http://thehill.com/blogs/congress-blog/education/214268-consumers-have-a-right-to-know-where-their-food-comes-from)
- sustainable fishery?
